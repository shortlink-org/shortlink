{{- if and .Values.deploy.env.MQ_ENABLED (eq .Values.deploy.env.MQ_TYPE "kafka") }}
---
# LinkCreated event topic - canonical name: link.link.created.v1
# Follows ADR-0002 canonical event naming standard
apiVersion: kafka.strimzi.io/v1
kind: KafkaTopic
metadata:
  name: link.link.created.v1
  namespace: kafka
  labels:
    strimzi.io/cluster: shortlink
spec:
  partitions: {{ .Values.kafka.topics.partitions | default 1 }}
  replicas: {{ .Values.kafka.topics.replicas | default 3 }}
  config:
    retention.ms: {{ .Values.kafka.topics.retention.ms | default 7200000 }}
    segment.bytes: {{ .Values.kafka.topics.segment.bytes | default 31457280 }}
---
# LinkUpdated event topic - canonical name: link.link.updated.v1
# Follows ADR-0002 canonical event naming standard
apiVersion: kafka.strimzi.io/v1
kind: KafkaTopic
metadata:
  name: link.link.updated.v1
  namespace: kafka
  labels:
    strimzi.io/cluster: shortlink
spec:
  partitions: {{ .Values.kafka.topics.partitions | default 1 }}
  replicas: {{ .Values.kafka.topics.replicas | default 3 }}
  config:
    retention.ms: {{ .Values.kafka.topics.retention.ms | default 7200000 }}
    segment.bytes: {{ .Values.kafka.topics.segment.bytes | default 31457280 }}
---
# LinkDeleted event topic - canonical name: link.link.deleted.v1
# Follows ADR-0002 canonical event naming standard
apiVersion: kafka.strimzi.io/v1
kind: KafkaTopic
metadata:
  name: link.link.deleted.v1
  namespace: kafka
  labels:
    strimzi.io/cluster: shortlink
spec:
  partitions: {{ .Values.kafka.topics.partitions | default 1 }}
  replicas: {{ .Values.kafka.topics.replicas | default 3 }}
  config:
    retention.ms: {{ .Values.kafka.topics.retention.ms | default 7200000 }}
    segment.bytes: {{ .Values.kafka.topics.segment.bytes | default 31457280 }}
{{- end }}
