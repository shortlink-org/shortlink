base:
  enabled: true

istiod:
  enabled: true

  global:
    logAsJson: true

    istiod:
      enableAnalysis: true

    tracer:
      zipkin:
        address: grafana-tempo.grafana:9411

  ## Discovery Settings
  pilot:
    traceSampling: 100.0

    env:
      ENABLE_NATIVE_SIDECARS: "false"
      ISTIO_ENABLE_CONTROLLER_QUEUE_METRICS: "false"

  istio_cni:
    enabled: true

  # meshConfig defines runtime configuration of components, including Istiod and istio-agent behavior
  # See https://istio.io/docs/reference/config/istio.mesh.v1alpha1/ for all available options
  meshConfig:
    enableTracing: true
    defaultConfig:
      tracing:
        max_path_tag_length: 99999
        sampling: 100
        zipkin:
          address: grafana-tempo.grafana:9411
    extensionProviders:
      - name: zipkin
        zipkin:
          service: grafana-tempo.grafana
          port: 9411
      - name: otel
        envoyOtelAls:
          service: grafana-tempo.grafana
          port: 4317
#    discoverySelectors:
#      - matchLabels:
#          istio-discovery: enabled
#    defaultConfig:
#      proxyMetadata:
#        ISTIO_META_ENABLE_HBONE: "true"

  telemetry:
    v2:
      metadataExchange:
        wasmEnabled: true
      prometheus:
        enabled: true
        wasmEnabled: true
        configOverride:
          scrapeInterval: 15s
          scrapeTimeout: 10s
