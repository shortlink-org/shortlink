# BUILD IMAGE ==========================================================================================================
trigger:build_api:
  stage: build
  variables:
    REGISTRY_IMAGE: $CI_REGISTRY_IMAGE/api
    DOCKERFILE_PATH: ops/dockerfile/shortlink.Dockerfile
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/build.yml'
    strategy: depend
  needs:
    - gosec
    - gotest
    - golint
  rules:
    - if: $CI_COMMIT_TAG
      when: on_success

trigger:build_logger:
  stage: build
  variables:
    REGISTRY_IMAGE: $CI_REGISTRY_IMAGE/logger
    DOCKERFILE_PATH: ops/dockerfile/logger.Dockerfile
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/build.yml'
    strategy: depend
  needs:
    - gosec
    - gotest
    - golint
  rules:
    - if: $CI_COMMIT_TAG
      when: on_success

trigger:build_ui:
  stage: build
  variables:
    REGISTRY_IMAGE: $CI_REGISTRY_IMAGE/ui-nuxt
    DOCKERFILE_PATH: ops/dockerfile/ui-nuxt.Dockerfile
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/build.yml'
    strategy: depend
  needs: []
  rules:
    - if: $CI_COMMIT_TAG

pages:
  stage: build
  variables:
    DOCS_FOLDER: "docs"
    SPEC_TO_DISPLAY: "api.swagger.json"
  only:
    - tags
