include:
  - template: Verify/Browser-Performance.gitlab-ci.yml
  - template: Verify/Accessibility.gitlab-ci.yml
  - template: DAST.gitlab-ci.yml

# Read more about the feature here: https://docs.gitlab.com/ee/user/project/merge_requests/accessibility_testing.html
a11y:
  rules:
    - when: on_success

performance:
  stage: accessibility
  variables:
    URL: $ENVIRONMENT_URL
  allow_failure: true
  rules:
    - when: on_success

# Docs: https://gitlab.com/help/user/application_security/dast/index.md
dast:
  stage: accessibility
  variables:
    DAST_WEBSITE: $ENVIRONMENT_URL
    GITLAB_FEATURES: dast
  rules:
    - if: $CI_COMMIT_TAG
      when: on_success
    - if: $CI_COMMIT_BRANCH
      when: on_success
