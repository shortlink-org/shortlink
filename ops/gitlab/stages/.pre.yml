# ANSIBLE ==============================================================================================================
ansible-up:
  stage: .pre
  when: manual
  image: quay.io/ansible/creator-ee:v0.4.0
  before_script:
    - sed -i 's/mirrorlist/#mirrorlist/g' /etc/yum.repos.d/CentOS-Linux-*
    - sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g' /etc/yum.repos.d/CentOS-Linux-*
    - yum install make -y
  script:
    - make ansible-locale

# TERRAFORM ============================================================================================================
terraform-up:
  stage: .pre
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/terraform.yml'
  when: manual

# K8S ==================================================================================================================
infrastructure:
  stage: .pre
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_additional.yml'
  when: manual

# SCHEDULE =============================================================================================================
delete_renovate_branch:
  stage: .pre
  image: alpine:3.15
  script:
    - echo 123
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: always
