// Code generated by protoc-gen-gotemplate. DO NOT EDIT.
// source: pkg/link/link.proto
{{ $MyType := upperFirst .File.Package }}{{ $myType := lowerFirst .File.Package }}{{ $commands := list "Ne" "Eq" "Le" "Lt" "Ge" "Gt" "Contains" "NotContains" }}{{ $sqlCommands := list "Eq" "NotEq" "Lt" "LtOrEq" "Gt" "GtOrEq" "Like" "NotLike" }}
package postgres

import (
	"github.com/Masterminds/squirrel"

	"github.com/batazor/shortlink/internal/store/query"
)

func (p *PostgresLinkList) buildFilter(query squirrel.SelectBuilder, filter *query.Filter) squirrel.SelectBuilder {
	if filter != nil {

{{- range $command := $sqlCommands }}
		clauses{{$command}} := squirrel.{{$command}}{}
{{- end}}

{{- range $type := .File.MessageType}}
{{- range $field := $type.Field}}
{{- range $index, $command := $commands }}{{ if ne (upperFirst $field.Name) $MyType }}

		if filter.{{ upperFirst $field.Name }} != nil {
			if filter.{{ upperFirst $field.Name }}.{{$command}} != nil {
				clauses{{ index $sqlCommands $index }}["{{$field.Name}}"] = filter.{{ upperFirst $field.Name }}.{{$command}}
			}
		}
		{{- end}}{{- end}}{{- end}}{{- end}}

	{{- range $command := $sqlCommands }}
		query = query.Where(clauses{{$command}})
	{{- end}}
	}

	return query
}
